/*支付状态展示*/
function payState() {
    var paystate = window.location.search;
    if (paystate == '?result=success') {
        $('.account .status-success').css({ 'display': 'block' }).siblings().css({ 'display': 'none' });
    } else if (paystate == '?result=fail') {
        $('.account .status-fail').css({ 'display': 'block' }).siblings().css({ 'display': 'none' });
    } else {
        $('.account .status-box').css({ 'display': 'none' });
    }
}
/*取出session值*/
Date.prototype.format = function(format) {
    var date = {
           "M+": this.getMonth() + 1,
           "d+": this.getDate(),
           "h+": this.getHours(),
           "m+": this.getMinutes(),
           "s+": this.getSeconds(),
           "q+": Math.floor((this.getMonth() + 3) / 3),
           "S+": this.getMilliseconds()
    };
    if (/(y+)/i.test(format)) {
           format = format.replace(RegExp.$1, (this.getFullYear() + '').substr(4 - RegExp.$1.length));
    }
    for (var k in date) {
           if (new RegExp("(" + k + ")").test(format)) {
                  format = format.replace(RegExp.$1, RegExp.$1.length == 1
                         ? date[k] : ("00" + date[k]).substr(("" + date[k]).length));
           }
    }
    return format;
}
function getStore() {
    var money = sessionStorage.getItem("money");
    var wxUrl = sessionStorage.getItem("wxUrl");
    var acctName = sessionStorage.getItem("acctName", acctName);
    var balance = sessionStorage.getItem("balance", balance);
    /*充值成功时间戳转换*/
    var finishTime = sessionStorage.getItem("finishTime", finishTime);
    var successTime=new Date(finishTime);
    finishTime=successTime.format('yyyy年MM月dd日 hh:mm');
    $('.account .recharge-ok .name').html(acctName);
    $('.account .recharge-ok .time').html(finishTime);
    $('.account .recharge-ok .money').html('￥' + (money*1).toFixed(2));
    $('.account .recharge-ok .balance').html('￥' + (balance*1+money*1).toFixed(2));
    if (money || wxUrl || acctName || balance || finishTime) {
        sessionStorage.getItem("money", "");
        sessionStorage.getItem("wxUrl", "");
        sessionStorage.getItem("acctName", "");
        sessionStorage.getItem("balance", "");
        sessionStorage.getItem("finishTime", "");
    }
}
/*判断是否从微信支付页面跳转*/
function fromWechat(){
    var from=sessionStorage.getItem('from');
    if(from=="account-wechat-pay"){
        $('.account .status-success').css({ 'display': 'block' }).siblings().css({ 'display': 'none' });
    }
}
$(document).ready(function() {
    getStore();
    payState();
    fromWechat();
});
